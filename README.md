Deploying a game app using Azure DevOps in Azure App Service using docker.

Description 
There is a game project I found in github and it seems to be a interesting project. So today, I’ll be deploying that project in Azure App service using Azure DevOps.

So to do this, first we’ll create docker file, then login to azure portal and create container registry and App Service.

Now we’ll login to ADO portal and create build and release pipeline. Build pipeline will build the app and push the image to Azure container registry and release pipeline will deploy the application to Azure Web App.

While describing the steps, I am assuming you are aware of the container registry and App service in Azure Cloud and build and release pipeline in ADO.

Pre-req:


•	GitHub account
•	Azure Subscription
•	Knowledge on Linux, Docker, Azure DevOps, Container Registry, Azure Key Vault. 

Procedure 

•	Clone/download the repository  https://github.com/Shiazy18/2048-game.git
•	Create dockerfile (Although docker file is already present in the above repo just for your reference, but if you want you can delete and create a new dockerfile).
•	We’ll use the below command to create Dockerfile:
FROM ubuntu:22.04

Run apt-get update
Run apt-get install -y nginx

RUN echo "daemon off;" >>/etc/nginx/nginx.conf

COPY . /var/www/html

EXPOSE 80

CMD["/usr/sbin/nginx", "-c", "/etc/nginx/nginx.conf"]



•	Commit the changes.


•	Login to Azure DevOps portal https://dev.azure.com/ and click on new project and create new project. 


 


•	Open the project click on Repository, then files and take the url (either HTTPS or SSH )to push the code with Dockerfile in the repo.

 

 








•	Then click on build pipeline and create a pipeline using classic editor.

 




•	Then select your repo and branch
 


•	Select task as build and push image and inside agent pool, I have used Azure Pipeline agent pool with Ubuntu latest image. If you have any custom pool you can use that.
 



•	Confure your build an image task as follows:
 




•	Configure your push an image task as follows
 

•	Create a Web App (App service) in Azure portal, and make sure in Publish you are choosing docker container as below

 


•	And your overall App Service should look like as below

 

•	Now again go to ADO portal and select your project and click on Pipeline -> Release.
•	Create new release and click on empty job
 





•	Select the artifact (which is generated by your build pipeline) and click on stage section

 

•	Here also in pipeline select agent pool as ubuntu

 
•	And then click on select task and look for azure web app and fill the desired field as per required. You can take help of below snapshot.

 



•	Click on save and create release. Your build and release pipeline is ready. 

Your pipeline may look something like this
 





Wait! Wait! Wait!!! The project is not yet over. There is one more step left, which is enabling continuous integration and continuous 

To do so click on build pipeline and select trigges, there click on enable continuous integration, select your repo and branch and the click save and queue

 

After that go to your build pipeline and select deployment trigger and follow as shown below:

 

You can check if your pipeline is working or not by simply making any changes in the code or by creating the a new branch and merging that brancjh with develop branch. The build pipeline should automatically be triggered and when the build is succeeded the release will start. 

Conclusion

In the following project we learnt how to create a dockerfile, Web App, Container registry and in-dept knowledge of Azure Devops. We also know how we can deploy any application by simply creating its image into Azure Web App.












